---
import { Image } from "astro:assets";

import NavList from "@/components/nav/NavList.vue";
import NavMenu from "@/components/nav/NavMenu.vue";
import DarkLightToggle from "@/components/nav/DarkLightToggle.vue";

import logo_img from "@/assets/logo.webp";
import { links } from "@/content/nav_links";

const route_prefix = Astro.url.pathname.split("/").splice(0, 2).join("/");
const curr_idx =
  route_prefix === "/"
    ? -1
    : links.findIndex((link) => link.route.startsWith(route_prefix));
---

<nav
  class="
    sticky top-0 z-10
    grid grid-cols-[1fr_auto_1fr] items-center
    w-full h-[var(--navbar-height)]
    px-5
    bg-light-bg-top dark:bg-dark-bg-top
    text-dark-text-normal
  "
>
  <a href="/" class="justify-self-start inline-block dark:saturate-50">
    <Image src={logo_img} alt="logo" class="logo w-10 md:w-15" />
  </a>

  <NavList {curr_idx} {links} client:load />

  <div class="justify-self-end lt-md:flex md:pr-15">
    <NavMenu {curr_idx} {links} client:load />
    <DarkLightToggle client:idle />
  </div>
</nav>

<style>
  .logo {
    filter: drop-shadow(0 1px rgba(255, 255, 255, 0.5))
      drop-shadow(0 -1px rgba(255, 255, 255, 0.5))
      drop-shadow(1px 0 rgba(255, 255, 255, 0.5))
      drop-shadow(-1px 0 rgba(255, 255, 255, 0.5));
  }
  .logo:hover {
    filter: drop-shadow(2px 0 2px rgba(255, 255, 255, 0.5))
      drop-shadow(-2px 0 2px rgba(255, 255, 255, 0.5))
      drop-shadow(0 2px 2px rgba(255, 255, 255, 0.5))
      drop-shadow(0 -2px 2px rgba(255, 255, 255, 0.5));
  }
</style>